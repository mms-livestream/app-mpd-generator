
function mpdGenerator() {

    var date = new Date();
    var hour = date.getHours() - 2;
    hour = (hour < 10 ? "0" : "") + hour;
    var min  = date.getMinutes();
    min = (min < 10 ? "0" : "") + min;
    var sec  = date.getSeconds();
    sec = (sec < 10 ? "0" : "") + sec;

    var secPublish  = date.getSeconds() + 10;
    secPublish = (secPublish < 10 ? "0" : "") + secPublish;
    

    var year = date.getFullYear();
    var month = date.getMonth() + 1;
    month = (month < 10 ? "0" : "") + month;
    var day  = date.getDate();
    day = (day < 10 ? "0" : "") + day;

    var availabilityStartTime = year + "-" + month + "-" + day + "T" + hour + ":" + min + ":" + sec + ".000";
    //YYYY:MM:DD:HH:MM:SS
    var publishTime = year + "-" + month + "-" + day + "T" + hour + ":" + min + ":" + secPublish + ".000";


    var fs = require('fs');
    fs.writeFile("mpd.mpd",
    
    
   `
<?xml version="1.0"?>
<MPD xmlns="urn:mpeg:dash:schema:mpd:2011" minBufferTime="PT1.500S" type="dynamic" availabilityStartTime="${availabilityStartTime}" publishTime="${publishTime}" maxSegmentDuration="PT0H0M6.000S" minimumUpdatePeriod="P0Y0M0DT0H10M30.000S" profiles="urn:mpeg:dash:profile:isoff-live:2011" GOP="12" numberOfServers="1">
<ProgramInformation moreInformationURL="http://gpac.sourceforge.net">
<Title>mpd.mpd generated by GPAC</Title>
</ProgramInformation>
<Period id="p0" start="P0Y0M0DT0H0M0.000S">
<!--
 <BaseURL>http://localhost:8080/segment/2/</BaseURL>
-->
<AdaptationSet segmentAlignment="true" maxWidth="640" maxHeight="480" maxFrameRate="24" par="16:9" lang="und">
<BaseURL>http://192.168.2.130:8080/api/description/1/</BaseURL>
<SegmentTemplate timescale="12288" media="$Bandwidth$/out$Bandwidth$_dash$Number$.m4s" startNumber="2" duration="98304" initialization="$Bandwidth$/out$Bandwidth$_dash.mp4"/>
<Representation id="1" mimeType="video/mp4" codecs="avc1.4d4028" width="640" height="480" frameRate="24" sar="4:3" startWithSAP="1" bandwidth="500000"></Representation>
<Representation id="2" mimeType="video/mp4" codecs="avc1.4d4028" width="640" height="480" frameRate="24" sar="4:3" startWithSAP="1" bandwidth="1000000"></Representation>
<Representation id="3" mimeType="video/mp4" codecs="avc1.4d4028" width="640" height="480" frameRate="24" sar="4:3" startWithSAP="1" bandwidth="2000000"></Representation>
</AdaptationSet>
</Period>
</MPD> `
    
    
    
    , function(err) {
    if(err) {
        return console.log(err);
    }

    console.log("The mpd was saved!");
}); 
}

mpdGenerator();

